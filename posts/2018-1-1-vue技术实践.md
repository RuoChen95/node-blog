---
layout: post
title: vue技术实践回顾
---
本文的主要目的是梳理过去三个月的时间在公司使用vue的经过，碰到的相关信息，以及需要改进的问题。目标读者是对vue以及前端有兴趣的人。

本文会一直更新，直到商城全部重构完成。

Vue.js是一个开源Javascript框架，用于构建用户界面，由于是数据驱动的，不用查找DOM元素，所以这个框架能够简化代码，加快开发速度。Vue还有官方library，包括用于控制路由的vue-routing，也有用于状态管理的vuex。Vue的主要功能比较简单，容易入手，功能相对来说比较全面，所以我们决定使用vue。

## vue下的登录

用户登录比较复杂，目前了解到，其涉及到4处服务器：

1. 本机（用户）
2. 登录服务器（接口提供方）
3. cas服务器（公用）
4. redis服务器（公用）

登录的具体步骤为：

1. PC打开网页，向登录服务器发送请求，由于没有ticket，登录服务器返回401；
2. PC重定向到cas服务器，进行登录，登录成功后cas服务器生成ticket传给PC端，并且生成对应的ticket表（包括用户信息以及对应的），并将ticket表上传到redis服务器中。
3. PC获取ticket后再向登录服务器发送请求，登录服务器获取ticket后到redis服务器中进行核对，核对通过，登录成功。

补充：第二部成功后，cas服务器会生成JSESSIONID，种植到浏览器的cookie中；登录服务器通过校验用户名 + JSESSIONID + ticket来判断用户是否登录了。

## vue的组件封装

vue的生态繁荣，框架比较多，在UI工具上，我们用了elementUI以及iviewUI。这些UI工具其实就是一些封装好的组件，用法官网上写得很明确了。

样式自定义：需要去App.vue文件中进行全局修改，不能在不同的组件文件中进行修改，否则会由于vue的组件绑定机制导致修改失效。[iview](https://www.iviewui.com/docs/guide/theme)上说的变量覆盖方法并非最简。

组件功能复用：使用[混合](https://cn.vuejs.org/v2/guide/mixins.html#%E5%9F%BA%E7%A1%80)，此部分待续...

普通组件以及实例化组件：框架自带的实例化组件只能同时使用一个，所以有的时候需要两者共同使用。

父子组件通信：上行使用“:”，下行使用“@”，具体用法可见官网。父子组件通信也可以用vuex，但是vuex + 异步传输存在问题。

## 接口对接

进行重构的很重要一点就是要注意之前的接口是如何写的，这样才能全面了解项目的需求以及代码量。除此之外，开始mock接口前需要花一些时间来核对接口的合理性，接口确定后尽量不要修改，这样就能加快开发速度。

在对接时，要和后端沟通好，接口之后必然有修改，要预留足够的修改时间。

## 功能封装

详见下一篇文章。